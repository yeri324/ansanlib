<!DOCTYPE html>

<script>

	$('.modal').on('hidden.bs.modal', function (e) {
		console.log('modal close');
		$(this).find('form')[0].reset()
	});

	$("#checkEmail").click(function () {
		let userEmail = $("#userEmail").val();
		let userName = $("#userName").val();

		$.ajax({
			type: "GET",
			url: "/check/findPw",
			data: {
				"userEmail": userEmail,
				"userName": userName
			},
			success: function (res) {
				if (res['check']) {
					swal("발송 완료!", "입력하신 이메일로 임시비밀번호가 발송되었습니다.", "success").then((OK) = > {
						if(OK) {
							$.ajax({
								type: "POST",
								url: "/check/findPw/sendEmail",
								data: {
									"userEmail": userEmail,
									"userName": userName
								}
							})
							window.location = "/login";
						}


					}
					)
					$('#checkMsg').html('<p style="color:darkblue"></p>');
				} else {
					$('#checkMsg').html('<p style="color:red">일치하는 정보가 없습니다.</p>');
				}
			}
		})
	})
</script>

<div class="container">
	<!-- Modal -->
	<div class="modal fade" id="myModal" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header" style="padding:35px 50px;">
					<h4><span class="glyphicon glyphicon-lock"></span>아이디찾기</h4>
				</div>
				<div class="modal-body" style="padding:40px 50px;">
			
					<hr>
					<form role="form">
						<div class="form-group">
							<label for="userEmail"><span class="glyphicon glyphicon-user"></span>이메일</label>
							<input type="text" class="form-control" id="userEmail" placeholder="이메일입력">
						</div>
						<div class="form-group">
							<label for="userId"><span class="glyphicon glyphicon-eye-open"></span>이름</label>
							<input type="text" class="form-control" id="Name" placeholder="이름입력">
						</div>
						<button type="button" class="btn btn-success btn-block" id="checkEmail">아이디 확인</button>
					</form>
					<hr>
					<div class="text-center small mt-2" id="checkMsg" style="color: red"></div>
				</div>
				<div class="modal-footer">
					<button class="btn btn-primary" onClick="location.href='/users/login'">로그인</button>
					<button type="button" class="btn btn-primary" onClick="location.href='/users/findpwd'">비밀번호찾기</button>
				</div>
			</div>

		</div>
	</div>
</div>